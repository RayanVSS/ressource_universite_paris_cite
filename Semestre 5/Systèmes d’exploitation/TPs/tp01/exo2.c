#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include <signal.h>
#include <sys/wait.h>
#include <sys/types.h>
#include <errno.h>
#include <dirent.h>
#include <sys/stat.h>

void checkDir (char * path) {
    DIR * dir = opendir(path);
    if (dir == NULL) {
        perror("opendir");
        exit(EXIT_FAILURE);
    }
    struct dirent * entry ;
    while ((entry = readdir(dir)) != NULL) {
       if (strcasecmp(entry->d_name , ".") == 0 || strcasecmp(entry->d_name , "..") == 0) continue;
       struct stat st;
       lstat(entry->d_name , &st);
       if (S_ISDIR(st.st_mode)) {
            char path2[BUFSIZ] = {0};
            sprintf(path2 , "%s/%s" , path , entry->d_name);
            checkDir(path2);
            continue;
        }
        if (S_ISLNK(st.st_mode)) {
            char path2[BUFSIZ] = {0};
            sprintf(path2 , "%s/%s" , path , entry->d_name);
            char buff[BUFSIZ] = {0};
            readlink(path2 , buff , BUFSIZ);
            printf("%s -> %s\n" , path2 , buff);
            continue;
        }

    }
}

int main(int argc, char const *argv[]){
    int pipefd[2] = {-1 , -1};
    pipe(pipefd);
    close(pipefd[0]);
    write(pipefd[1] , "1" , 1);
    printf("here\n");
    // char buff[BUFSIZ] = {0};
    // DIR * dir = opendir(".");
    // sprintf(buff , "./");
    // struct dirent * entry ;
    // while ((entry = readdir(dir)) != NULL) {
    //    if (strcasecmp(entry->d_name , ".") == 0 || strcasecmp(entry->d_name , "..") == 0) continue;
    //    struct stat st;
    //    lstat(entry->d_name , &st);
    //    if (S_ISDIR(st.st_mode)) {
           
    //    }
    // }
    return 0;
}
