#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include <signal.h>
#include <sys/wait.h>
#include <sys/types.h>
#include <errno.h>

// int main(int argc, char const *argv[]){
//     int pipefd[2] = {-1 , -1};
//     pipe(pipefd);
//     if (fork() == 0) {
//         int pipefd2[2] = {-1 , -1};
//         pipe(pipefd2);
//         if (fork() == 0) {
//             puts("ping");
//             write(pipefd2[1] , "1" , 1);
//         }else {
//             read(pipefd2[0] , NULL , 1);
//             puts("pong") ; 
//             write(pipefd[1] , "1" , 1);
//         }
//     }else {
//         read(pipefd[0] , NULL , 1);
//         if (fork() == 0) puts("pang");
//     }
//     return 0;
// }

void h1 (int sig) {}

int main(int argc, char const *argv[]){
    struct sigaction action = {0};
    action.sa_handler = h1;
    sigaction(SIGUSR1 , &action , NULL);

    sigset_t mask;
    sigemptyset(&mask);
    pid_t pid1 ; 
    if ((pid1 = fork()) == 0) {
        pid_t pid2 ; 
        if ((pid2 = fork()) == 0) {
            puts("ping");
            kill(getppid() , SIGUSR1);
        }else {
            sigsuspend(&mask);
            puts("pong") ; 
            kill(getppid() , SIGUSR1);
        }
    }else {
        sigsuspend(&mask);
        if (fork() == 0) puts("pang");
    }
    return 0;
}
