#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include <signal.h>
#include <sys/wait.h>
#include <sys/types.h>
#include <errno.h>
#include <dirent.h>
#include <sys/stat.h>

int f () {
    DIR *dir = opendir(".");
    int nb = 0 ; 
    struct dirent *entry ;
    struct stat st ; 
    while ((entry = readdir(dir)) != NULL) {
        if (strcmp(entry->d_name , ".") == 0 || strcmp(entry->d_name , "..") == 0) {
            continue;
        }
        stat(entry->d_name , &st);
        if (S_ISDIR(st.st_mode)) {
            chdir(entry->d_name);
            nb += 1 + f();
            chdir(".."); 
        }
    }
    closedir(dir);
    return nb;
}

int main(int argc, char const *argv[]){
    // printf("nb de dossier : %d\n" , f()+1);
    int pi[2] = {-1 , -1} ; 
    char buff[32];
    pipe(pi) ; 
    pid_t pid = fork();
    switch (pid) {
        case 0:
            printf("ping\n"); 
            write(pi[1] , "a" , 1);
            while (read(pi[0] , buff , 2) != 2){
                write(pi[1] , "a" , 1);
            }
            printf("pang\n");
            
        case -1:
            exit(EXIT_FAILURE);
        default:
            read(pi[0] , buff , 1);
            printf("pong\n");
            write(pi[1] , "aa" , 2);
            break;    
    }
    return 0;
}
