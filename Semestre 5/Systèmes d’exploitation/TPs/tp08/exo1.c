#include "sys/types.h"
#include "sys/unistd.h"
#include "sys/wait.h"
#include "fcntl.h"
#include "stdlib.h"
#include "stdio.h"

int main(int argc, char const *argv[]){
    int p[2] = {-1 , -1} ; 
    pipe(p) ; 
    pid_t r = fork() ; 
    switch (r){
    case -1:
        perror("error");
        close(p[0]);
        close(p[1]); 
        break;
    
    case 0:
        int res ; 
        if (read(p[0] , &res , sizeof(int)) == 0) {
            perror("reading err") ; 
            return EXIT_FAILURE;
        }
        printf("j'ai eu => %d\n" , res);
        return EXIT_SUCCESS; 
    
    default:
        srandom(getppid()) ; 
        int rand = random() ; 
        if (!write(p[1] , &rand , sizeof(int))) {
            perror("writing err") ;
            return EXIT_FAILURE;
        }
        break;
    }
    
    return 0;
}
