#include <stdlib.h>
#include <stdio.h>
#include <unistd.h>
#include <fcntl.h>
#include <sys/stat.h>

int main(int argc, char const *argv[])
{
	int fd1 = open("toto", O_RDWR | O_CREAT, S_IRUSR | S_IWUSR), fd2;
	char c = 'a';
	int i;

	if (fork() == 0)
		c = 'b';

	// Après le fork, chacun ouvre titi, mais dans son coin. 
	// Donc ça pointe vers une entrée différente dans la table des ouvertures

	// 1e6 = 1 milion (1 et 6 0)
	fd2 = open("titi", O_WRONLY | O_CREAT, S_IRUSR | S_IWUSR);
	for (i = 0; i < 1e3; i++) {
		write(fd1, &c, sizeof(char));
	}

	for (i = 0; i < 1e3; i++) {
		write(fd2, &c, sizeof(char));
	}

	return 0;
}